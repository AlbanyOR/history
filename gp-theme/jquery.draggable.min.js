(function(b){var c={active:true,limits:null,$handle:null,targets:"",stored:[]};var a={__construct:function(d){this.data("drag",b.extend({},c,d));var e=this.data("drag");if(!e.$handle){e.$handle=this}a.enable.call(this);return this},disable:function(){var d=this.data("drag");d.$handle.unbind("mousedown.draggable");d.active=false},_initDrag:function(g,f,d){b("body").css("cursor","move");d.deltaXY=[g.screenX-parseInt(f.css("left")),g.screenY-parseInt(f.css("top"))];b(document).bind("mousemove.draggable",function(h){h.preventDefault();if(d.stored.length==0&&d.targets){b(d.targets).each(function(){var e=b(this),j=e.position(),j=[j.left,j.top,j.left+e.width(),j.top+e.height()];d.stored.push(j)})}var i={left:h.screenX-d.deltaXY[0],top:h.screenY-d.deltaXY[1]};if(typeof(d.limits)=="object"){i=a._checkPos.call(f,i)}f.css(i).trigger("dragged",[h,a._getCurTargets(h.pageX,h.pageY,d.stored)])});b(document).bind("mouseup.draggable",function(h){b(document).unbind("mousemove.draggable mouseup.draggable");b("body").css("cursor","auto");f.trigger("stopDrag",[h,a._getCurTargets(h.pageX,h.pageY,d.stored)]);d.stored=[]});f.trigger("startDrag",[g])},_getCurTargets:function(d,h,e){var g=[];if(e.length>0){for(var f in e){if(e[f][0]<d&&e[f][1]<h&&e[f][2]>d&&e[f][3]>h){g.push(f)}}}return g},enable:function(){var e=this,d=this.data("drag");d.$handle.bind("mousedown.draggable",function(f){f.preventDefault();f.stopPropagation();a._initDrag.call(this,f,e,d)});d.active=true;return this},setLimits:function(d){var e=this.data("drag").limits=d;return this},isDraggable:function(){return this.data("drag")==null?false:true},_checkPos:function(e){var d=this.data("drag");if(d.limits){if(e.left<d.limits.left){e.left=d.limits.left}if(e.left>d.limits.right){e.left=d.limits.right}if(e.top<d.limits.top){e.top=d.limits.top}if(e.top>d.limits.bottom){e.top=d.limits.bottom}}return e}};b.fn.draggable=function(e,d){if(a[e]){return a[e].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof e==="object"||!e){return a.__construct.apply(this,arguments)}else{b.error("Method "+e+" does not exist on jQuery.draggable")}}}})(jQuery);